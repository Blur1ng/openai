# Repository Code Exporter

Скрипт для экспорта всего кода из git-репозитория в один текстовый файл с учетом исключений из `.gitignore` и пользовательского конфига.

## Установка зависимостей

```bash
pip install -r export_requirements.txt
```

## Использование

### Базовое использование

```bash
python export_repo.py <URL_репозитория> <путь_к_конфигу>
```

### Примеры

```bash
# Экспорт с дефолтным именем выходного файла (repo_export.txt)
python export_repo.py https://github.com/user/repo export_config.json

# Экспорт с указанием выходного файла
python export_repo.py https://github.com/user/repo export_config.json -o output.txt

# Использование SSH URL
python export_repo.py git@github.com:user/repo.git export_config.json -o code.txt
```

### Аргументы

- `repo_url` - URL git-репозитория (https или ssh) - **обязательный**
- `config` - Путь к JSON файлу с конфигурацией исключений - **обязательный**
- `-o, --output` - Путь к выходному текстовому файлу (по умолчанию: `repo_export.txt`) - опциональный

## Формат конфигурационного файла

Конфигурационный файл в формате JSON содержит списки исключений:

```json
{
  "exclude_patterns": [
    "*.pyc",
    "*.log",
    "__pycache__/",
    "*.min.js"
  ],
  "exclude_directories": [
    ".git",
    ".idea",
    "node_modules",
    "venv"
  ],
  "exclude_files": [
    ".gitignore",
    "LICENSE"
  ]
}
```

### Поля конфигурации

- **`exclude_patterns`** - Список паттернов для исключения файлов (поддерживает glob-паттерны как в `.gitignore`)
- **`exclude_directories`** - Список названий директорий для полного исключения
- **`exclude_files`** - Список конкретных файлов для исключения (относительные пути от корня репозитория)

Пример конфигурации находится в файле `export_config.json`.

## Формат выходного файла

Выходной файл содержит содержимое всех файлов в следующем формате:

```
=== path/to/file1.py ===
<содержимое файла>
---
=== path/to/file2.js ===
<содержимое файла>
---
```

## Особенности

1. **Автоматическое клонирование** - Репозиторий клонируется во временную директорию, которая автоматически удаляется после завершения работы
2. **Учет `.gitignore`** - Скрипт автоматически читает и применяет правила из `.gitignore` репозитория
3. **Фильтрация бинарных файлов** - Бинарные файлы автоматически пропускаются
4. **Обработка ошибок кодировки** - Файлы с проблемами кодировки пропускаются с выводом предупреждения
5. **Shallow clone** - Используется `depth=1` для ускорения клонирования

## Логика исключений

Файл будет исключен если:
1. Он находится в директории `.git`
2. Он соответствует паттернам из `.gitignore` репозитория
3. Он соответствует паттернам из `exclude_patterns` конфига
4. Он находится в директории из `exclude_directories` конфига
5. Его путь указан в `exclude_files` конфига
6. Он является бинарным файлом

## Примеры использования

### Экспорт собственного проекта

```bash
python export_repo.py https://github.com/myusername/myproject export_config.json -o myproject_code.txt
```

### Экспорт с минимальными исключениями

Создайте minimal_config.json:

```json
{
  "exclude_patterns": ["*.pyc"],
  "exclude_directories": [".git"],
  "exclude_files": []
}
```

```bash
python export_repo.py https://github.com/user/repo minimal_config.json
```

### Экспорт только Python файлов

Создайте python_only_config.json с обширным списком исключений для других типов файлов:

```json
{
  "exclude_patterns": [
    "*.js",
    "*.css",
    "*.html",
    "*.json",
    "*.md",
    "*.txt",
    "*.yaml",
    "*.yml"
  ],
  "exclude_directories": [".git", "node_modules", "static"],
  "exclude_files": []
}
```

## Требования

- Python 3.7+
- git (установленный в системе)
- Зависимости из `export_requirements.txt`:
  - gitpython>=3.1.40
  - pathspec>=0.11.2

## Возможные ошибки

### "Ошибка при клонировании репозитория"

- Проверьте правильность URL репозитория
- Убедитесь, что у вас есть доступ к репозиторию (для приватных репозиториев)
- Проверьте наличие SSH ключей (для SSH URLs)

### "Файл конфигурации не найден"

- Проверьте путь к конфигурационному файлу
- Убедитесь, что файл существует

### "Неверный формат JSON"

- Проверьте синтаксис JSON в конфигурационном файле
- Используйте JSON валидатор

## Лицензия

Свободное использование.

